<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <base target="_blank"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> [#0013] Google Assistant allows leaking personal data via Bluetooth headphones | feed </title> <meta name="description" content=" xdavidhu&#39;s bug bounty disclosures. "> <meta name="keywords" content=""> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="xdavidhu"> <meta name="twitter:title" content="Google Assistant allows leaking personal data via Bluetooth headphones"> <meta name="twitter:description" content="xdavidhu's bug bounty disclosures."> <meta name="twitter:image:src" content="http://192.168.56.106:9885/asd/assets/img/cover.png"> <!-- Social: Open Graph --> <meta name="title" property="og:title" content="Google Assistant allows leaking personal data via Bluetooth headphones"> <meta name="description" property="og:description" content="xdavidhu's bug bounty disclosures."> <meta name="image" property="og:image" content="http://192.168.56.106:9885/asd/assets/img/cover.png"> <meta name="author" content="David Schütz"> <!-- Canonical link tag --> <link rel="canonical" href="http://192.168.56.106:9885/asd/bugs/0013"> <link rel="alternate" type="application/rss+xml" title="feed" href="http://192.168.56.106:9885/asd/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="http://192.168.56.106:9885/asd/assets/css/main.css"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav> <div class="container nav-container"> <h1 class="logo"><a href="http://192.168.56.106:9885/asd/" target="_self">feed<span></span></a></h1> <ul class="navbar"> <li><a href="https://bugs.xdavidhu.me/" target="_self">bugs.xdavidhu.me</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"> <span>#0013</span><br/> <span>Vendor: Google</span><br/> <span>Status: fixed</span><br/> <span>Reported: Jan 27, 2021</span><br/> <span>Disclosed: </span><time datetime="2022-02-06T00:00:00+00:00" itemprop="datePublished">Feb 06, 2022</time> (375 days) </p> <h1 class="post-title" itemprop="name headline">Google Assistant allows leaking personal data via Bluetooth headphones</h1> </header> <div class="post-content" itemprop="articleBody"> <p><em>This report is generated based on a comment of mine in <a href="/bugs/0012" target="_self">b/167400928</a></em></p> <p><strong>Summary:</strong></p> <p>Disabling <code class="language-plaintext highlighter-rouge">On headphones</code> in the Google app’s <code class="language-plaintext highlighter-rouge">Personalization</code> settings page still allows normal Bluetooth headphones to make personal queries on the locked screen. Also, the toggle which controls this, <code class="language-plaintext highlighter-rouge">Allow Bluetooth requests with device locked</code>, is enabled by default on every Android device with a Google app, while personal results on Pixel Buds &amp; wired headphones require opt-in &amp; approval from the user.</p> <p><strong>Details:</strong></p> <ul> <li>The “personal results” settings are now moved to a different location (<code class="language-plaintext highlighter-rouge">Google App</code> -&gt; <code class="language-plaintext highlighter-rouge">More</code> -&gt; <code class="language-plaintext highlighter-rouge">Settings</code> -&gt; <code class="language-plaintext highlighter-rouge">Google Assistant</code> -&gt; <code class="language-plaintext highlighter-rouge">Personalization</code>), where it should give you a central control page over all of the “personal results” settings. This would be great, but it does not contain all “personal results” settings, therefore it might confuse users and give a false sense of security.</li> <li>If on this page you disable everything lock screen related (<code class="language-plaintext highlighter-rouge">Lock screen personal results</code>, <code class="language-plaintext highlighter-rouge">Personal suggestions on lock screen before you ask</code>, <code class="language-plaintext highlighter-rouge">On headphones</code>) you would think that now, there is no way to get personal results on the lock screen. <strong>This is not true.</strong></li> <li><strong>“Normal” bluetooth headphones can still issue personal queries.</strong> To turn that off, you would have to go to <code class="language-plaintext highlighter-rouge">Google App</code> -&gt; <code class="language-plaintext highlighter-rouge">More</code> -&gt; <code class="language-plaintext highlighter-rouge">Settings</code> -&gt; <code class="language-plaintext highlighter-rouge">Voice</code> and disable <code class="language-plaintext highlighter-rouge">Allow Bluetooth requests with device locked</code>. <strong>This is enabled by default!</strong></li> <li>So, on the <code class="language-plaintext highlighter-rouge">Personalization</code> page, turning off <code class="language-plaintext highlighter-rouge">On headphones</code> <strong>only affects wired headphones</strong>, and some special Bluetooth headphones, like the Pixel Buds. <strong>Other normal BT headphones/speakers are unaffected</strong> by this, they are controlled by the <code class="language-plaintext highlighter-rouge">Allow Bluetooth requests with device locked</code>, which is on a completely different page. <strong>This <code class="language-plaintext highlighter-rouge">On headphones</code> setting should control every type of headphone/BT device.</strong></li> <li>After looking at two different devices, and resetting the Google app on one, I can confirm that <code class="language-plaintext highlighter-rouge">Allow Bluetooth requests with device locked</code> is <strong>enabled by default</strong>. Why is that? It doesn’t feel right. For every other type of headphone (wired, Pixel Buds), you have to specially opt-in to allow personal results.</li> <li>Also, confusingly, on the <code class="language-plaintext highlighter-rouge">Voice</code> page, you still have the <code class="language-plaintext highlighter-rouge">Allow wired headset requests with device locked</code>, which is now basically useless and doesn’t do anything, and sometimes toggling it redirects you to the <code class="language-plaintext highlighter-rouge">Personalization</code> page, but sometimes it does not, allowing you to toggle the switch, which just adds to the confusion.</li> </ul> <p>So, all in all, “lock screen personal results” is in my opinion very sensitive setting, which should be presented very clearly to the users, and currently I doubt that an average user could make sense of all of this mess, and configure their device securely.</p> <p><strong>Impact</strong></p> <p>Currently, since <code class="language-plaintext highlighter-rouge">Allow Bluetooth requests with device locked</code> is <strong>enabled by default</strong>, if you have physical access to someone’s phone &amp; an already paired BT headphone (which are usually stored together), <strong>you can just ask personal queries</strong> without knowing the unlock credentials on most of the Android devices out there. A user who proactively wants to turn this off, and disables <code class="language-plaintext highlighter-rouge">On headphones</code> on the <code class="language-plaintext highlighter-rouge">Personalization</code> settings page is still vulnerable.</p> <hr /> <h3 id="comments">Comments:</h3> <p><strong>Vendor</strong></p> <p><em>automated response acknowledging my report</em></p> <hr /> <p><strong>Vendor</strong></p> <p>Thank David,</p> <p>Thanks again for sharing this - I’ve filed a bug based on your report.</p> <p>Although that might not qualify for a reward in scope of the program. The panel will still evaluate it at the next VRP panel meeting and we’ll update you once we’ve got more information. All you need to do now is wait. If you don’t hear back from us in 2-3 weeks or have additional information about the vulnerability, let us know!</p> <p>Regards, <br /> [redacted], Google Trust &amp; Safety Team</p> <hr /> <p><strong>Vendor</strong></p> <p><em>automated response of a $1337.00 reward</em></p> <hr /> <p><strong>Me</strong></p> <p>Hi,</p> <p>Is it possible to ask what the fix will be for this issue?</p> <p>Putting every personal-result setting in the same place, under <code class="language-plaintext highlighter-rouge">Personalization</code> should of course be one of the fixes, but I’m not quite sure what the solution is for the default-enabled <code class="language-plaintext highlighter-rouge">Allow Bluetooth requests with device locked</code>.</p> <p>Will it be turned off for everyone? So they have to re-enable it? That seems like the best solution from a privacy standpoint.</p> <p>If you have any updates or if a fix is rolling out, let me know, I will try it!</p> <p>Thanks, <br /> David</p> <hr /> <p><strong>Vendor</strong></p> <p>Hi David,</p> <p>I connected with the product team and they got back to me with the message that I included below. Having said that, they are still working on resolving this issue and you will get a notification once the fix has been released. Let us know if you have any idea about the date for your blog. We are looking forward to it ;)</p> <p>Also, if the message below is still unclear, if you have any feedback about this message or if you have questions after the fix goes out let us know as well.</p> <p>Best, <br /> [redacted]</p> <ul> <li>When you asked Google Assistant “what restaurants have I visited,” that request should have been treated as a verified query, which requires that an opt-in setting is enabled to answer your question by providing Personal Results on <a href="https://support.google.com/assistant/answer/9134021?hl=en">phone lock screens</a> or on <a href="https://support.google.com/assistant/answer/7684543">shared devices</a>. <ul> <li>On Android phones, people can choose to enable “personal” content (e.g. things like results from your Google Calendar, access to your contacts etc) to show on their phone lock screen. This setting is off by default, and lock screen personal results are only available when the Assistant recognizes <a href="https://support.google.com/assistant/answer/9071681?hl=en">your voice</a>.</li> <li>Similarly, on shared devices like speakers and smart displays, you can choose to turn on the Personal Results setting to allow the Assistant to provide this personal content when you ask for it. Again, if you have set up Voice Match, your personal results are available only when the Assistant recognizes your voice, or on smart displays, if you have chosen to have personal results shown to you proactively.</li> <li>Thanks to your report, we’ve identified the source of the issue that led to a temporary misclassification of this query, and have rolled out a fix for mobile devices last October, and a fix was recently rolled out on smart speakers.</li> <li>As people’s interactions with Google Assistant expand, we continually evaluate what queries should be verified to serve a personal result to make sure we are getting it right.</li> </ul> </li> <li>Personal results for the Android lock screen are disabled by default – and people can choose their settings and if they want their personal results to surface while their phone is locked. <ul> <li>A subset of personal queries including (but not limited to) payments, photos, your name or home address will always require the user to unlock their phone.</li> </ul> </li> <li>On mobile devices, you can control what kinds of info Google Assistant will say or show when your device is locked. If personal results on the lock screen are enabled but you would like to disable them on your <a href="https://support.google.com/assistant/answer/9134021?hl=en">Android</a> phone, simply: <ul> <li>Invoke Assistant with unlocked screen and say “Open Assistant settings” – or go to <a href="https://support.google.com/assistant/answer/9193492">Assistant settings</a></li> <li>Tap on “See all Assistant Settings &gt; “Personalization”</li> <li>Turn off the “Lock screen Personal Results” setting</li> </ul> </li> <li>Some Google Assistant devices, like speakers and Smart Displays, can be shared with multiple people. For any shared device, you can <a href="https://support.google.com/assistant/answer/7684543?co=GENIE.Platform%3DAndroid&amp;hl=en#zippy=%2Cspeakers-smart-displays-smart-clocks">turn personal results on or off</a>: <ul> <li>Open the Google Home app</li> <li>At the bottom, tap Home and then select your device</li> <li>At the top right, tap Device settings</li> <li>Tap “Recognition &amp; Personalization”</li> <li>Turn “Allow personal results” on or off</li> </ul> </li> <li>By default, Assistant’s settings do not allow personal results access to headphones. <ul> <li>Thanks to your report, we’ve identified that for some models, bluetooth headphones were not properly configured under Assistant’s personal results settings. Instead, they operated under a separate bluetooth setting, which was not the intended behavior. We’re actively working on the fix and it will be available in an upcoming Android Google app release.</li> </ul> </li> </ul> <hr /> <p><strong>Me</strong></p> <p>Hi,</p> <p>Thank you for the detailed response!</p> <p>I noticed that the last statement in my opinion is incorrect, saying <code class="language-plaintext highlighter-rouge">By default, Assistant’s settings do not allow personal results access to headphones</code>, and I want to make sure this is clear for the team as well:</p> <p>I can confirm after trying on multiple devices, that after reinstalling the Google app, the <code class="language-plaintext highlighter-rouge">Allow Bluetooth requests with device locked</code> setting got enabled on all of the tested devices. I just got a Pixel 5 yesterday, and the setting was enabled there also, by default, so I had to turn it off manually.</p> <p>Again, the impact of having this setting enabled by default:</p> <p>Currently, since <code class="language-plaintext highlighter-rouge">Allow Bluetooth requests with device locked</code> is <strong>enabled by default</strong>, if you have physical access to someone’s phone &amp; an already paired BT headphone (which are usually stored together), <strong>you can just ask personal queries</strong> without knowing the unlock credentials on most of the Android devices out there.</p> <p>And I don’t think this is intended behaviour, that is why I asked in comment #5 about the plans of fixing this issue:</p> <p>Will it be turned off for everyone by rolling out a fix? So users will have to re-enable it? That seems like the best solution from a privacy standpoint. Or will moving this setting to the it’s proper place, (into <code class="language-plaintext highlighter-rouge">Personalization</code>) would fix this issue as well?</p> <p>Thank you, David</p> <hr /> <p><strong>Vendor</strong></p> <p>Hey there!</p> <p>Understood! We’ll get this back to the team :-)</p> <p>Once we are ready to share the fix we’ll get back to you.</p> <hr /> <p><strong>Me</strong></p> <p>Hey,</p> <p>Just a heads-up: From my testing it looks like all of the issues are fixed. I will be disclosing this report with all additional comments (with names redacted), this week.</p> <p>Thank you, <br /> David</p> </div> </article> </main> </body> </html>
