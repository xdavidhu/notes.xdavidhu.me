<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <base target="_blank"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> [#0015] Viewing Instagram live streams anonymously without notifying the host | feed </title> <meta name="description" content=" xdavidhu&#39;s bug bounty disclosures. "> <meta name="keywords" content=""> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="xdavidhu"> <meta name="twitter:title" content="Viewing Instagram live streams anonymously without notifying the host"> <meta name="twitter:description" content="xdavidhu's bug bounty disclosures."> <meta name="twitter:image:src" content="http://192.168.56.106:9885/asd/assets/img/cover.png"> <!-- Social: Open Graph --> <meta name="title" property="og:title" content="Viewing Instagram live streams anonymously without notifying the host"> <meta name="description" property="og:description" content="xdavidhu's bug bounty disclosures."> <meta name="image" property="og:image" content="http://192.168.56.106:9885/asd/assets/img/cover.png"> <meta name="author" content="David Schütz"> <!-- Canonical link tag --> <link rel="canonical" href="http://192.168.56.106:9885/asd/bugs/0015"> <link rel="alternate" type="application/rss+xml" title="feed" href="http://192.168.56.106:9885/asd/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="http://192.168.56.106:9885/asd/assets/css/main.css"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav> <div class="container nav-container"> <h1 class="logo"><a href="http://192.168.56.106:9885/asd/" target="_self">feed<span></span></a></h1> <ul class="navbar"> <li><a href="https://bugs.xdavidhu.me/" target="_self">bugs.xdavidhu.me</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"> <span>#0015</span><br/> <span>Vendor: Meta</span><br/> <span>Status: <span style='color: red;'>wont-fix</span></span><br/> <span>Reported: May 01, 2022</span><br/> <span>Disclosed: </span><time datetime="2022-09-02T00:00:00+00:00" itemprop="datePublished">Sep 02, 2022</time> (124 days) </p> <h1 class="post-title" itemprop="name headline">Viewing Instagram live streams anonymously without notifying the host</h1> </header> <div class="post-content" itemprop="articleBody"> <p><strong>Description/Impact:</strong></p> <p>An attacker can set up a rule to drop all requests the Instagram app is making to <code class="language-plaintext highlighter-rouge">/api/v1/live/[broadcast_id]/heartbeat_and_get_viewer_count/</code> and join a livestream. Since all heartbeat requests will fail, the host will not get notified that attacker joined the livestream, and the viewer count will not increase. Meanwhile the attacker will have full access to the livestream, anonymously.</p> <p>I tested the attack on private “practice” livestream. I assume the behaviour is the same on a public live stream. Exploiting this bug on a private “practice” livestream is more impactful than on a public one.</p> <p>The attacker could watch the livestream while the host assumes that the attacker is not there. If there are no other viewers, the host will assume he/she is still alone in the livestream, even though the attacker is watching.</p> <p><strong>Repro Steps:</strong></p> <p>Mobile app version: 232.0.0.16.114</p> <p>[setup]</p> <ol start="0"> <li>Create 2 instagram users: Victim &amp; Attacker</li> <li>Message each other &amp; approve the message requests, so that the users can freely send messages to each other</li> </ol> <p>[repro]</p> <ol> <li>[Victim] Open the new live stream UI and set the audience (eye icon) to “Practice”</li> <li>[Victim] Start the live stream</li> <li>[Victim] Click the share icon and send the live stream to Attacker (this is necessary because its a “Practice” live. As i mentioned before this should work on public lives as well.)</li> <li>[Attacker] Start proxying the requests with Burp, and set up a new “Match and replace” rule under <code class="language-plaintext highlighter-rouge">Proxy</code> -&gt; <code class="language-plaintext highlighter-rouge">Options</code>. Set Type to <code class="language-plaintext highlighter-rouge">Request header</code>, match to <code class="language-plaintext highlighter-rouge">heartbeat_and_get_viewer_count</code> and replace to <code class="language-plaintext highlighter-rouge">heartbeat_and_get_viewer_counts</code></li> <li>[Attacker] Open the message Victim sent in Step 3. and click on the live stream</li> <li>[Attacker] Watch the livestream anonymously while for Victim it looks like he/she is in the live stream alone</li> </ol> <p><em>This report has been part of the Meta BountyConEDU 2022 live hacking event in Madrid, Spain.</em></p> <hr /> <h3 id="discussion">Discussion:</h3> <p><strong>Vendor - 2022-05-01</strong></p> <p>Hi Dávid,</p> <p>Thank you for the report. The viewer count isn’t meant to be a security or a privacy measure nor guarantee accuracy. For the case of private “practice” live case, the victim would not send the link of their live if they want don’t want any one else to see it. For the case of public live - lives are meant to be watched by people so it doesn’t really matter if someone can watch it “anonymously”. As such, I am going to close the report, but look forward to receiving more reports from you :)</p> <p>Thanks, <br /> <em>[redacted]</em> <br /> Security engineer</p> <hr /> <p><strong>Me - 2022-05-01</strong></p> <p>Hi <em>[redacted]</em>,</p> <p>I disagree, I think this is a privacy issue. Here is why I think that:</p> <p>I was able to reproduce that the host can’t see the attacker when clicking his/her username on the top left corner. On that screen all viewers should be visible. This means that the host can’t even remove the attacker from the livestream.</p> <p>This allows the attacker to anonymously snoop on a livestream indefinitely, without the victim knowing, which is a privacy issue.</p> <p>Thank you, <br /> David</p> <hr /> <p><strong>Me - 2022-05-01</strong></p> <p>An example scenario:</p> <ol> <li>Victim starts a new practice livestream</li> <li>Victim invites 10 people to the stream</li> <li>One person joins, they start to talk one-on-one, while waiting for others to join, expecting they are alone</li> <li>Attacker snoops on the livestream, potentially leaking sensitive conversations/content</li> </ol> <p>The example is similar to a Google Meet / Zoom call. Even though you join a call with a public link, you trust the user interface to inform you about who is in the call with you.</p> <p>Thank you, <br /> David</p> <hr /> <p><strong>Vendor - 2022-05-01</strong></p> <p>Hi Dávid, When someone has a live session, it should be assumed that their actions are recorded and live streamed, therefore privacy cannot be expected. If a user wants no one to see or hear them, they should not do a live stream or turn off the live stream, camera or microphone.</p> <p>Thanks,</p> <p><em>[redacted]</em>, Security</p> </div> </article> </main> </body> </html>
